"0","adult %>%"
"0","  count(native_country, wage) %>%"
"0","  group_by(native_country) %>%"
"0","  mutate(total_each_n = sum(n)) %>%"
"0","  mutate(ratio_each_edu_wage = round(n / total_each_n*100, 1)) -> df_tmp"
"0",""
"0","df_tmp %>% "
"0","  filter(wage == "">50K"") %>%"
"0","  arrange(desc(ratio_each_edu_wage)) %>% pull(native_country) -> x_axis_order"
"0",""
"0","df_tmp %>%"
"0","  ungroup() %>%"
"0","  mutate(native_country = factor(native_country, levels = x_axis_order, labels = x_axis_order)) %>%"
"0","  filter(!is.na(native_country)) %>%"
"0","  filter(native_country != ""?"") -> df_tmp_1"
"0",""
"0","df_tmp_1 %>%"
"0","  ggplot(aes(native_country, n, fill = wage)) +"
"0","  geom_bar(stat = 'identity', position = 'fill') +"
"0","  scale_color_manual(values = c('steelblue', 'red'), aesthetics = 'fill') +"
"0","  ylab(""Ratio"") +"
"0","  theme_minimal() +"
"0","  coord_flip() -> p; p"
